hashmap map
while 1
  receive OFPacketIn
  s = socket that sent OFPacketIn
  si = source interface
  di = destination interface
  src = source address of OFPacketIn
  dst = destination address of OFPacketIn
  n = linked list node

  //add src to map if not already there
  if map contains key src
    //get linked list node from map with key src
    n = map.get(src)
    while n != null
      if n.switch = s
        if n.interface == null
          n.interface == si
          break
  else create map entry with key src
  if linked list doesn't contain node for switch s
    add node to linked list for switch s

  //get interface for dst
  check map for key dst
  if map contains dst
    search linked list for switch s
    if list contains s
      send packet through interface in node
  else
    for every interface except si
      send the packet
